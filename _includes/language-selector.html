<div class="language-selector">
  {% assign current_page_url = page.url %}

  {% if page.url contains '/en/' or page.lang == 'en' %}
    <span class="language active">English</span>
    {% if page.url contains '/en/about/' %}
      <a href="{{ '/es/about/' | relative_url }}" class="language">Español</a>
      <a href="{{ '/about/' | relative_url }}" class="language">Português</a>
    {% else %}
      <a href="{{ '/es/' | relative_url }}" class="language">Español</a>
      <a href="{{ '/' | relative_url }}" class="language">Português</a>
    {% endif %}
  {% elsif page.url contains '/es/' or page.lang == 'es' %}
    <a href="{{ '/en/' | relative_url }}" class="language">English</a>
    <span class="language active">Español</span>
    {% if page.url contains '/es/about/' %}
      <a href="{{ '/about/' | relative_url }}" class="language">Português</a>
    {% else %}
      <a href="{{ '/' | relative_url }}" class="language">Português</a>
    {% endif %}
  {% else %}
    <a href="{{ '/en/' | relative_url }}" class="language">English</a>
    <a href="{{ '/es/' | relative_url }}" class="language">Español</a>
    <span class="language active">Português</span>
  {% endif %}
</div>